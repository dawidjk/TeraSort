---


---

<h1 id="tera-sort">Tera Sort</h1>
<p>The goal of <em>Tera Sort</em> was to learn about distributed systems. In order to achieve this, I set out in a mission to make my own little cluster. As soon as the Raspberry Pi 4 had launched, I purchased 4 - eventually acquiring 4 more (my cluster is now at 8 woot!). Together with 5 terabytes worth of disk storage, we can now benchmark the system… But how do we do such a thing you may mask?<br>
…<br>
Easy!<br>
…<br>
By sorting a terabyte of random 64 bit binary encoded integers. And so, I introduce: <em>Tera Sort</em></p>
<h1 id="the-setup">The Setup</h1>
<div class="mermaid"><svg xmlns="http://www.w3.org/2000/svg" id="mermaid-svg-ZV9t8nHOw3iIFsog" width="100%" style="max-width: 907.8328094482422px;" viewBox="0 0 907.8328094482422 513.0625"><g transform="translate(-12, -12)"><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath" style="opacity: 1;"><path class="path" d="M74.44092590873605,245.53125L162.015625,63.3828125L217.265625,63.3828125" marker-end="url(#arrowhead7302)" style="fill:none"></path><defs><marker id="arrowhead7302" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M96.55715272620816,245.53125L162.015625,200.1484375L217.265625,200.1484375" marker-end="url(#arrowhead7303)" style="fill:none"></path><defs><marker id="arrowhead7303" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M96.55715272620816,291.53125L162.015625,336.9140625L217.265625,336.9140625" marker-end="url(#arrowhead7304)" style="fill:none"></path><defs><marker id="arrowhead7304" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M74.44092590873605,291.53125L162.015625,473.6796875L217.265625,473.6796875" marker-end="url(#arrowhead7305)" style="fill:none"></path><defs><marker id="arrowhead7305" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M304.03125,63.3828125L343.6640625,63.3828125L383.296875,63.3828125" marker-end="url(#arrowhead7306)" style="fill:none"></path><defs><marker id="arrowhead7306" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M304.03125,200.1484375L343.6640625,200.1484375L383.296875,200.1484375" marker-end="url(#arrowhead7307)" style="fill:none"></path><defs><marker id="arrowhead7307" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M304.03125,336.9140625L343.6640625,336.9140625L383.296875,336.9140625" marker-end="url(#arrowhead7308)" style="fill:none"></path><defs><marker id="arrowhead7308" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M304.03125,473.6796875L343.6640625,473.6796875L383.296875,473.6796875" marker-end="url(#arrowhead7309)" style="fill:none"></path><defs><marker id="arrowhead7309" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M470.0625,63.3828125L544.0859375,63.3828125L654.773151540018,232.8674749858606" marker-end="url(#arrowhead7310)" style="fill:none"></path><defs><marker id="arrowhead7310" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M470.0625,200.1484375L544.0859375,200.1484375L638.8195329015153,248.82109362436333" marker-end="url(#arrowhead7311)" style="fill:none"></path><defs><marker id="arrowhead7311" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M470.0625,336.9140625L544.0859375,336.9140625L638.819530882095,289.24140740797384" marker-end="url(#arrowhead7312)" style="fill:none"></path><defs><marker id="arrowhead7312" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M470.0625,473.6796875L544.0859375,473.6796875L654.7731503355104,305.1950268613893" marker-end="url(#arrowhead7313)" style="fill:none"></path><defs><marker id="arrowhead7313" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M738.0984359741209,269.03125L785.2703094482422,268.53125L832.9421844482422,268.53125" marker-end="url(#arrowhead7314)" style="fill:none"></path><defs><marker id="arrowhead7314" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="translate(162.015625,63.3828125)" style="opacity: 1;"><g transform="translate(-30.25,-13)" class="label"><foreignObject width="60.5" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">1/4 data</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(162.015625,200.1484375)" style="opacity: 1;"><g transform="translate(-30.25,-13)" class="label"><foreignObject width="60.5" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">1/4 data</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(162.015625,336.9140625)" style="opacity: 1;"><g transform="translate(-30.25,-13)" class="label"><foreignObject width="60.5" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">1/4 data</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(162.015625,473.6796875)" style="opacity: 1;"><g transform="translate(-30.25,-13)" class="label"><foreignObject width="60.5" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">1/4 data</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(343.6640625,63.3828125)" style="opacity: 1;"><g transform="translate(-14.6328125,-13)" class="label"><foreignObject width="29.265625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Sort</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(343.6640625,200.1484375)" style="opacity: 1;"><g transform="translate(-14.6328125,-13)" class="label"><foreignObject width="29.265625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Sort</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(343.6640625,336.9140625)" style="opacity: 1;"><g transform="translate(-14.6328125,-13)" class="label"><foreignObject width="29.265625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Sort</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(343.6640625,473.6796875)" style="opacity: 1;"><g transform="translate(-14.6328125,-13)" class="label"><foreignObject width="29.265625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Sort</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(544.0859375,63.3828125)" style="opacity: 1;"><g transform="translate(-49.0234375,-13)" class="label"><foreignObject width="98.046875" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Return Sorted</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(544.0859375,200.1484375)" style="opacity: 1;"><g transform="translate(-49.0234375,-13)" class="label"><foreignObject width="98.046875" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Return Sorted</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(544.0859375,336.9140625)" style="opacity: 1;"><g transform="translate(-49.0234375,-13)" class="label"><foreignObject width="98.046875" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Return Sorted</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(544.0859375,473.6796875)" style="opacity: 1;"><g transform="translate(-49.0234375,-13)" class="label"><foreignObject width="98.046875" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Return Sorted</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(785.2703094482422,268.53125)" style="opacity: 1;"><g transform="translate(-22.671875,-13)" class="label"><foreignObject width="45.34375" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Merge</span></div></foreignObject></g></g></g><g class="nodes"><g class="node" id="A" transform="translate(63.3828125,268.53125)" style="opacity: 1;"><rect rx="5" ry="5" x="-43.3828125" y="-23" width="86.765625" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-33.3828125,-13)"><foreignObject width="66.765625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Aspen 01</div></foreignObject></g></g></g><g class="node" id="B" transform="translate(260.6484375,63.3828125)" style="opacity: 1;"><circle x="-43.3828125" y="-23" r="43.3828125"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-33.3828125,-13)"><foreignObject width="66.765625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Aspen 01</div></foreignObject></g></g></g><g class="node" id="C" transform="translate(260.6484375,200.1484375)" style="opacity: 1;"><circle x="-43.3828125" y="-23" r="43.3828125"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-33.3828125,-13)"><foreignObject width="66.765625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Aspen 02</div></foreignObject></g></g></g><g class="node" id="D" transform="translate(260.6484375,336.9140625)" style="opacity: 1;"><circle x="-43.3828125" y="-23" r="43.3828125"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-33.3828125,-13)"><foreignObject width="66.765625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Aspen 03</div></foreignObject></g></g></g><g class="node" id="E" transform="translate(260.6484375,473.6796875)" style="opacity: 1;"><circle x="-43.3828125" y="-23" r="43.3828125"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-33.3828125,-13)"><foreignObject width="66.765625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Aspen 03</div></foreignObject></g></g></g><g class="node" id="F" transform="translate(426.6796875,63.3828125)" style="opacity: 1;"><circle x="-43.3828125" y="-23" r="43.3828125"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-33.3828125,-13)"><foreignObject width="66.765625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Aspen 01</div></foreignObject></g></g></g><g class="node" id="G" transform="translate(426.6796875,200.1484375)" style="opacity: 1;"><circle x="-43.3828125" y="-23" r="43.3828125"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-33.3828125,-13)"><foreignObject width="66.765625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Aspen 02</div></foreignObject></g></g></g><g class="node" id="H" transform="translate(426.6796875,336.9140625)" style="opacity: 1;"><circle x="-43.3828125" y="-23" r="43.3828125"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-33.3828125,-13)"><foreignObject width="66.765625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Aspen 03</div></foreignObject></g></g></g><g class="node" id="I" transform="translate(426.6796875,473.6796875)" style="opacity: 1;"><circle x="-43.3828125" y="-23" r="43.3828125"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-33.3828125,-13)"><foreignObject width="66.765625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Aspen 04</div></foreignObject></g></g></g><g class="node" id="J" transform="translate(677.8539047241211,268.53125)" style="opacity: 1;"><polygon points="59.74453125,0 119.4890625,-59.74453125 59.74453125,-119.4890625 0,-59.74453125" rx="5" ry="5" transform="translate(-59.74453125,59.74453125)"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-33.3828125,-13)"><foreignObject width="66.765625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Aspen 03</div></foreignObject></g></g></g><g class="node" id="K" transform="translate(872.3874969482422,268.53125)" style="opacity: 1;"><rect rx="5" ry="5" x="-39.4453125" y="-23" width="78.890625" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-29.4453125,-13)"><foreignObject width="58.890625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Finished</div></foreignObject></g></g></g></g></g></g></svg></div>
<h2 id="specs">Specs</h2>
<p><strong>8x</strong> Raspberry Pi 4 (4gb) - 32gb RAM @ 1.5GHz/node<br>
<strong>2x</strong> Gigabit  network switches<br>
<strong>3x</strong> 1 TB HDD<br>
<strong>1x</strong> 2 TB HDD</p>
<h2 id="in-progress">In Progress:</h2>
<ul>
<li>Merging files after in memory sort</li>
</ul>
<h2 id="todo">TODO:</h2>
<ul>
<li>Network Communication</li>
<li>Kubernetes Orchestration</li>
<li>GitHub scoreboard</li>
</ul>
<h2 id="done">Done:</h2>
<ul>
<li>Benchmark timing</li>
<li>In memory sort optimization (turns out Go does a pretty good job)</li>
<li>Load integers from binary file</li>
<li>Create 1 TB of random integers and store as binary</li>
</ul>

